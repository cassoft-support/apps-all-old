# REST API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è app.cassoft.ru

> **–°—Ç–∞—Ç—É—Å:** üìã –¢—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–µ–∫—Ç–∞

## –û–±–∑–æ—Ä

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **app.cassoft.ru** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ë–∏—Ç—Ä–∏–∫—Å24 REST API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å CRM —Å–∏—Å—Ç–µ–º–æ–π.

**–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://dev.1c-bitrix.ru/rest_help/

---

## –ö–ª–∞—Å—Å CRest

–í—Å–µ –≤—ã–∑–æ–≤—ã API –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –∫–ª–∞—Å—Å `CRest`:

```php
$result = CRest::call('method.name', $params);
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```php
if (isset($result['error'])) {
    $errorCode = $result['error'];
    $errorDescription = $result['error_description'];
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏
}
```

---

## Disk API (—Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏)

### disk.folder.uploadfile
–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –≤ –ø–∞–ø–∫—É –ë–∏—Ç—Ä–∏–∫—Å24 Disk.

**–ú–µ—Ç–æ–¥:** `disk.folder.uploadfile`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```php
[
    'id' => $folderId,              // ID –ø–∞–ø–∫–∏ –≤ Bitrix24 Disk
    'data' => [
        'NAME' => $filename         // –ò–º—è —Ñ–∞–π–ª–∞
    ],
    'fileContent' => $fileContent   // –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ (base64 –∏–ª–∏ –ø–æ—Ç–æ–∫)
]
```

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```php
$result = CRest::call('disk.folder.uploadfile', [
    'id' => 12345,
    'data' => ['NAME' => 'photo.jpg'],
    'fileContent' => base64_encode($fileContent)
]);

if (!isset($result['error'])) {
    $fileId = $result['result']['ID'];
    $fileName = $result['result']['NAME'];
}
```

**–¢—Ä–µ–±—É–µ—Ç—Å—è:** –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Disk –º–µ—Ç–æ–¥—ã

---

## CRM API (—Ä–∞–±–æ—Ç–∞ —Å–æ —Å–¥–µ–ª–∫–∞–º–∏)

### crm.deal.get
–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–¥–µ–ª–∫–µ.

**–ú–µ—Ç–æ–¥:** `crm.deal.get`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```php
[
    'ID' => $dealId    // ID —Å–¥–µ–ª–∫–∏
]
```

**–ü—Ä–∏–º–µ—Ä:**
```php
$result = CRest::call('crm.deal.get', ['ID' => 123]);

if (!isset($result['error'])) {
    $deal = $result['result'];
    $title = $deal['TITLE'];
    $stage = $deal['STAGE_ID'];
}
```

### crm.deal.update
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏.

**–ú–µ—Ç–æ–¥:** `crm.deal.update`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```php
[
    'ID' => $dealId,
    'fields' => [
        'TITLE' => '–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ',
        'STAGE_ID' => 'NEW',
        // –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
    ]
]
```

**–ü—Ä–∏–º–µ—Ä:**
```php
$result = CRest::call('crm.deal.update', [
    'ID' => 123,
    'fields' => [
        'TITLE' => '–ö–≤–∞—Ä—Ç–∏—Ä–∞ –Ω–∞ —É–ª. –õ–µ–Ω–∏–Ω–∞',
        'OPPORTUNITY' => 5000000
    ]
]);
```

### crm.deal.fields
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª–µ–π —Å–¥–µ–ª–∫–∏.

**–ú–µ—Ç–æ–¥:** `crm.deal.fields`

**–ü—Ä–∏–º–µ—Ä:**
```php
$result = CRest::call('crm.deal.fields');

if (!isset($result['error'])) {
    $fields = $result['result'];
    // –ê–Ω–∞–ª–∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–ª–µ–π
}
```

**–¢—Ä–µ–±—É–µ—Ç—Å—è:** –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è

---

## CRM API (—Ä–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏)

### –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- crm.contact.get
- crm.contact.update
- (–¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã)

---

## CRM API (—Ä–∞–±–æ—Ç–∞ —Å –∫–æ–º–ø–∞–Ω–∏—è–º–∏)

### –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- crm.company.get
- crm.company.update
- (–¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã)

---

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ

**–¢—Ä–µ–±—É–µ—Ç—Å—è:** –ü–æ–∏—Å–∫ –≤—Å–µ—Ö –≤—ã–∑–æ–≤–æ–≤ `CRest::call()` –≤ –∫–æ–¥–µ –ø—Ä–æ–µ–∫—Ç–∞

### –ü–æ–∏—Å–∫ –≤ –∫–æ–¥–µ
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /var/www/bitirx-brokci/data/www/app.cassoft.ru
grep -r "CRest::call" --include="*.php"
```

### –¢–∞–±–ª–∏—Ü–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –º–µ—Ç–æ–¥–æ–≤

| –ú–µ—Ç–æ–¥ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ñ–∞–π–ª–∞—Ö | –ß–∞—Å—Ç–æ—Ç–∞ |
|-------|------------|----------------------|---------|
| disk.folder.uploadfile | –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ | ? | ? |
| crm.deal.get | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏ | ? | ? |
| crm.deal.update | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏ | ? | ? |
| crm.deal.fields | –ü–æ–ª—è —Å–¥–µ–ª–∫–∏ | ? | ? |
| ... | ... | ... | ... |

---

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```php
$result = CRest::call('method.name', $params);

if (isset($result['error'])) {
    error_log("Bitrix24 API Error: " . $result['error_description']);
    return false;
}

return $result['result'];
```

### 2. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
```php
$logFile = __DIR__ . '/logs/api.log';
$message = date('Y-m-d H:i:s') . " - API call: method.name\n";
file_put_contents($logFile, $message, FILE_APPEND);
```

### 3. –ü–∞–∫–µ—Ç–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (batch)
–î–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `batch` –º–µ—Ç–æ–¥:

```php
// –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ batch API
```

---

## –õ–∏–º–∏—Ç—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### Rate Limiting
- **–õ–∏–º–∏—Ç:** (—Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Ç–æ—á–Ω–µ–Ω–∏–µ)
- **–û–±—Ä–∞–±–æ—Ç–∫–∞:** (—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–∏—Å–∞–Ω–∏–µ)

### –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:** 50MB
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤:** 100 –∑–∞ –∑–∞–ø—Ä–æ—Å

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ó–∞–≥—Ä—É–∑–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
```php
// –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏ —Å —Ñ–∞–π–ª–∞–º–∏
```php
// –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞
```

---

## –°—Å—ã–ª–∫–∏

- [–ë–∏—Ç—Ä–∏–∫—Å24 REST API](https://dev.1c-bitrix.ru/rest_help/)
- [Disk API](https://dev.1c-bitrix.ru/rest_help/disk/)
- [CRM API](https://dev.1c-bitrix.ru/rest_help/crm/)

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** 11 –Ω–æ—è–±—Ä—è 2025 –≥.  
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü–æ–∏—Å–∫ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö API –≤—ã–∑–æ–≤–æ–≤ –≤ –∫–æ–¥–µ
